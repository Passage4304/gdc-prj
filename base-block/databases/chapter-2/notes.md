#### PGDATA
| Элемент              | Описание                                                                                                                                                                                                                                                                                                                                                                                                             |
|----------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| PG_VERSION           | Файл, содержащий основной номер версии PostgreSQL                                                                                                                                                                                                                                                                                                                                                                    |
| base                 | Подкаталог, содержащий подкаталоги для каждой базы данных                                                                                                                                                                                                                                                                                                                                                            |
| current_logfiles     | Файл, в котором записаны файлы журнала, в которые в данный момент записывается сборщик журналов.                                                                                                                                                                                                                                                                                                                     |
| global               | Подкаталог, содержащий таблицы всего кластера, такие как pg_database                                                                                                                                                                                                                                                                                                                                                 |
| pg_commit_ts         | Подкаталог, содержащий данные о временных метках фиксации транзакции                                                                                                                                                                                                                                                                                                                                                 |
| pg_dynshmem          | Подкаталог, содержащий файлы, используемые подсистемой динамической разделяемой памяти.                                                                                                                                                                                                                                                                                                                              |
| pg_logical           | Подкаталог, содержащий данные о состоянии для логического декодирования                                                                                                                                                                                                                                                                                                                                              |
| pg_multixact         | Подкаталог, содержащий данные о состоянии мультитранзакций (используется для общих блокировок строк)                                                                                                                                                                                                                                                                                                                 |
| pg_notify            | Подкаталог, содержащий данные о состоянии LISTEN/NOTIFY                                                                                                                                                                                                                                                                                                                                                              |
| pg_replslot          | Подкаталог, содержащий данные слота репликации                                                                                                                                                                                                                                                                                                                                                                       |
| pg_serial            | Подкаталог, содержащий информацию о зафиксированных сериализуемых транзакциях                                                                                                                                                                                                                                                                                                                                        |
| pg_snapshots         | Подкаталог, содержащий экспортированные снимки                                                                                                                                                                                                                                                                                                                                                                       |
| pg_stat              | Подкаталог, содержащий постоянные файлы для подсистемы статистики.                                                                                                                                                                                                                                                                                                                                                   |
| pg_stat_tmp          | Подкаталог, содержащий временные файлы для подсистемы статистики                                                                                                                                                                                                                                                                                                                                                     |
| pg_subtrans          | Подкаталог, содержащий данные о статусе субтранзакции                                                                                                                                                                                                                                                                                                                                                                |
| pg_tblspc            | Подкаталог, содержащий символические ссылки на табличные пространства                                                                                                                                                                                                                                                                                                                                                |
| pg_twophase          | Подкаталог, содержащий файлы состояния для подготовленных транзакций                                                                                                                                                                                                                                                                                                                                                 |
| pg_wal               | Подкаталог, содержащий файлы WAL (журнал упреждающей записи)                                                                                                                                                                                                                                                                                                                                                         |
| pg_xact              | Подкаталог, содержащий данные о состоянии фиксации транзакции                                                                                                                                                                                                                                                                                                                                                        |
| postgresql.auto.conf | Файл, используемый для хранения параметров конфигурации, которые задаются ALTER SYSTEM                                                                                                                                                                                                                                                                                                                               |
| postmaster.opts      | Файл, в котором записаны параметры командной строки, с которыми сервер был запущен в последний раз.                                                                                                                                                                                                                                                                                                                  |
| postmaster.pid       | Файл блокировки, в котором записаны текущий идентификатор процесса postmaster (PID), путь к каталогу данных кластера, временная метка запуска postmaster, номер порта, путь к каталогу сокета домена Unix (может быть пустым), первый действительный listen_address (IP-адрес или *, или пустым, если не прослушивается TCP), и идентификатор сегмента общей памяти (этот файл отсутствует после выключения сервера) |

#### Настройка логирования
```bash
### Раскомментировать: ###
logging_collector 
log_directory 
log_filename
```

#### Настройка подключения
```bash
### pg_hba.conf ###
# TYPE  DATABASE        USER            ADDRESS                 METHOD
local	dbname	username					                    md5
host	dbname	username	            127.0.0.1/32		    md5
```

#### Other
```sql
create table courses (
    course_id   int PRIMARY KEY,
    course_name varchar(50)
)
```

```bash
### Генерация данных ###
INSERT INTO students (student_id, name, age, group_id)
SELECT 
  s, 
  'Student_' || s, 
  18 + (s % 5), 
  1 + (s % 2)
FROM generate_series(1, 100000) AS s;
```

```sql
SELECT oid, datname FROM pg_database WHERE datname = current_database();
vacuum full table_name;
```

```bash
username@dbname FATAL:  pg_hba.conf rejects connection for host "[local]", user "username", database "dbname", no encryption
```

##### deadlock
| Действие                          | Команда или файл                           |
| --------------------------------- | ------------------------------------------ |
| Запустить параллельные транзакции | `BEGIN; UPDATE ...` в двух psql            |
| Создать deadlock                  | Взаимно блокировать строки                 |
| Проверить в логах                 | `/var/log/postgresql/postgresql-*.log`     |
| Настроить логирование             | `log_lock_waits=on`, `deadlock_timeout=1s` |
| Мониторить в реальном времени     | `pg_locks`, `pg_stat_activity`             |

```sql
set deadlock_timeout to 1;
```

